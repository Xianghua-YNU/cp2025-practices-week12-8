# 超新星数据拟合哈勃常数 - 实验报告

## 1. 实验目的

本实验旨在通过分析Ia型超新星的观测数据，使用最小二乘法拟合哈勃常数，理解宇宙膨胀的基本规律。具体目标包括：

- 掌握数据加载与预处理的基本方法
- 理解并实现加权最小二乘拟合算法
- 学习科学数据的可视化表示方法
- 理解哈勃定律及其在宇宙学中的意义

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：
<img width="816" alt="截屏2025-05-17 20 37 31" src="https://github.com/user-attachments/assets/c23e4783-c296-4722-a2f9-5b3eda3db8d5" />
<img width="791" alt="截屏2025-05-17 20 37 42" src="https://github.com/user-attachments/assets/8d7075cd-4745-427f-a09c-710ce6c7d33a" />
- 数据加载与预处理的实现方式
- 哈勃常数拟合的具体算法和实现细节
- 误差处理方法
- 可视化实现的关键步骤

## 3. 实验结果

### 3.1 数据加载结果

请简要描述加载的数据情况，包括数据点<img width="270" alt="截屏2025-05-17 20 48 55" src="https://github.com/user-attachments/assets/bcb397cd-8d19-494a-b306-bc86c79068f7" />
数量、红移范围等基本统计信息。

### 3.2 哈勃常数拟合结果

请在此处填写你拟合得到的哈勃常数及其误差：


H0 = [填写拟合值] ± [填写误差] km/s/Mpc
```

### 3.3 哈勃图

请在此处插入你绘制的哈勃图（距离模数vs红移）。图表应包含以下元素：

- 数据点（带误差棒）
- 最佳拟合曲线
- 图表标题："Hubble Diagram"
- X轴标签："Redshift z"
- Y轴标签："Distance modulus μ"
- 图例，包括数据点和拟合曲线的说明

### 3.4 核心代码片段

请在此处粘贴的代码
```python
```
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

# 加载数据
data = pd.read_csv('sn_data.csv')
z = data['z'].values
mu = data['mu'].values
mu_err = data['mu_err'].values

# 定义线性模型（小z近似）
def linear_model(z, a, b):
    return a + b * z

# 加权最小二乘拟合
weights = 1.0 / (mu_err ** 2)
popt, pcov = curve_fit(linear_model, z, mu, sigma=mu_err, absolute_sigma=True)
a_fit, b_fit = popt
a_err, b_err = np.sqrt(np.diag(pcov))

# 计算哈勃常数（需根据距离模数公式转换，此处为示例转换）
H0 = b_fit * (10 * np.log10(np.e)) / (3e5 / 1e6)  # 假设转换系数，需根据实际公式调整
H0_err = b_err * (10 * np.log10(np.e)) / (3e5 / 1e6)  # 误差传播

# 绘制哈勃图
plt.figure(figsize=(10, 6))
plt.errorbar(z, mu, yerr=mu_err, fmt='o', color='red', ecolor='gray', label='Data Points', capsize=5)
plt.plot(z, linear_model(z, *popt), 'b-', label='Best Fit')
plt.title('Hubble Diagram')
plt.xlabel('Redshift z')
plt.ylabel('Distance modulus μ')
plt.legend()
plt.grid(True)
plt.show()

## 4. 分析与讨论

### 4.1 拟合结果分析

请分析你拟合得到的哈勃常数值，与当前科学共识的哈勃常数值（约70 km/s/Mpc）进行比较。讨论可能的误差来源和影响因素。


### 4.2 误差分析

请讨论实验中可能的误差来源，包括但不限于：

- 数据本身的测量误差
- 拟合算法的局限性
- 模型假设的合理性
- 

### 4.3 思考题

1. 如果考虑相对论效应，对于较大的红移值，哈勃定律的表达式需要如何修正？这会对拟合结果产生什么影响？

2. 哈勃常数的精确测量对于理解宇宙的年龄、大小和演化有何重要意义？

3. 

## 5. 结论

请总结本次实验的主要发现和收获，特别是对哈勃定律和宇宙膨胀的理解。

## 6. 参考文献

请列出你在实验过程中参考的文献、书籍或网站。


